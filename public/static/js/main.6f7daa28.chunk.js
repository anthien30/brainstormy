(this.webpackJsonpbrainstormy=this.webpackJsonpbrainstormy||[]).push([[0],{151:function(e,t,n){},152:function(e,t,n){},153:function(e,t,n){},455:function(e,t,n){"use strict";n.r(t);var a=n(4),o=n(3),c=n.n(o),r=n(29),s=n.n(r),i=(n(151),n(68)),u=n(8),l=(n(152),n(153),function(e){return Object(a.jsxs)("div",{className:"login-page",children:[Object(a.jsx)("h3",{children:"Brainstormy"}),Object(a.jsx)("div",{children:e.children})]})}),d=n(41),b=n(7),j=n(67),g=n(31),f=n.n(g),v=n(47),O=n(43),h=function(e,t){switch(t.type){case"setObj":return console.log("Triggered"),Object(O.a)(Object(O.a)({},e),{},{googleObj:t.obj});case"setColorHexCode":return console.log("Triggered"),Object(O.a)(Object(O.a)({},e),{},{colorHexCode:t.obj});case"setCanvasId":return console.log("triggerd3 "+t.obj),Object(O.a)(Object(O.a)({},e),{},{canvasId:t.obj});default:return e}},E={googleObj:{},colorHexCode:"#000000",canvasId:-1},p=Object(o.createContext)(E),x=function(e){var t=e.children,n=Object(o.useReducer)(h,E),c=Object(b.a)(n,2),r=c[0],s=c[1];return Object(a.jsx)(p.Provider,{value:[r,s],children:t})},I=(n(154),n(456),n(156),{apiKey:"AIzaSyCVerinmEXYufNiKOsOtrKPaZo5o1okB3o",authDomain:"brainstormy-a370a.firebaseapp.com",databaseURL:"https://brainstormy-a370a-default-rtdb.firebaseio.com",projectId:"brainstormy-a370a",storageBucket:"brainstormy-a370a.appspot.com",messagingSenderId:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_FIREBASE_API_KEY:"AIzaSyCVerinmEXYufNiKOsOtrKPaZo5o1okB3o",REACT_APP_FIREBASE_MESSAGINGSENDERID:"31511364762",REACT_APP_FIREBASE_APPID:"1:31511364762:web:46646ba5958ba104c60b23",REACT_APP_FIREBASE_MEASUREMENTID:"G-QF9S44LLXN",REACT_APP_GOOGLE_CLIENT_ID:"31511364762-af73a2fcq1v6mgufrd5otqem4j5ksdi8.apps.googleusercontent.com"}).FIREBASE_MESSAGINGSENDERID,appId:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_FIREBASE_API_KEY:"AIzaSyCVerinmEXYufNiKOsOtrKPaZo5o1okB3o",REACT_APP_FIREBASE_MESSAGINGSENDERID:"31511364762",REACT_APP_FIREBASE_APPID:"1:31511364762:web:46646ba5958ba104c60b23",REACT_APP_FIREBASE_MEASUREMENTID:"G-QF9S44LLXN",REACT_APP_GOOGLE_CLIENT_ID:"31511364762-af73a2fcq1v6mgufrd5otqem4j5ksdi8.apps.googleusercontent.com"}).FIREBASE_APPID,measurementId:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_FIREBASE_API_KEY:"AIzaSyCVerinmEXYufNiKOsOtrKPaZo5o1okB3o",REACT_APP_FIREBASE_MESSAGINGSENDERID:"31511364762",REACT_APP_FIREBASE_APPID:"1:31511364762:web:46646ba5958ba104c60b23",REACT_APP_FIREBASE_MEASUREMENTID:"G-QF9S44LLXN",REACT_APP_GOOGLE_CLIENT_ID:"31511364762-af73a2fcq1v6mgufrd5otqem4j5ksdi8.apps.googleusercontent.com"}).FIREBASE_MEASUREMENTID});d.a.initializeApp(I);d.a.auth(),d.a.database(),new d.a.auth.GoogleAuthProvider;var S=function(e){var t,n=Object(o.useContext)(p),c=Object(b.a)(n,2),r=c[0],s=c[1];return Object(a.jsx)("div",{children:Object(a.jsx)(j.GoogleLogin,{clientId:"31511364762-af73a2fcq1v6mgufrd5otqem4j5ksdi8.apps.googleusercontent.com",buttonText:"Login",onSuccess:function(n){console.log("Login Success: currentUser:",n.profileObj);var a=function(){d.a.database().ref("board/"+n.profileObj.googleId).set({x1:0,y1:0,x2:-1,y2:-1,isDrawing:!1,colorHexCode:"#000000",canvasId:t},(function(e){alert("Write failed to ".concat(n.profileObj.googleId))})),d.a.database().ref("board/currentAvaliableCanvas").set(d.a.database.ServerValue.increment(1)),s({type:"setCanvasId",obj:t})};alert("Logged in successfully! Welcome ".concat(n.profileObj.name," \ud83d\ude0d. \n See console for full profile object.")),function(e){var t=1e3*(e.tokenObj.expires_in||3300),n=function(){var a=Object(v.a)(f.a.mark((function a(){var o;return f.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.reloadAuthResponse();case 2:o=a.sent,t=1e3*(o.expires_in||3300),console.log("newAuthRes:",o),localStorage.setItem("authToken",o.id_token),setTimeout(n,t);case 7:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}();setTimeout(n,t)}(n),e.setLoggedIn(!0),e.setName(n.profileObj.givenName),s({type:"setObj",obj:n.profileObj}),s({type:"setColorHexCode",obj:"#000000"}),console.log("googleID is  "+r.googleObj.googleId),d.a.database().ref("board/"+n.profileObj.googleId).once("value",(function(e){e.exists()?(d.a.database().ref("board/"+n.profileObj.googleId).update({x1:0,y1:0,x2:-1,y2:-1,isDrawing:!1,colorHexCode:"#000000"}),s({type:"setCanvasId",obj:e.val().canvasId})):d.a.database().ref("board/").once("value",(function(e){t=e.val().currentAvaliableCanvas}),(function(e){return alert("undefined")})).then(a).catch((function(e){return alert(e)}))}))},onFailure:function(e){console.log("Login failed: res:",e),alert("Failed to login \ud83d\ude22. Please try again")},cookiePolicy:"single_host_origin",isSignedIn:!0})})};var _=function(e){return Object(a.jsx)("div",{children:Object(a.jsx)(j.GoogleLogout,{clientId:"31511364762-af73a2fcq1v6mgufrd5otqem4j5ksdi8.apps.googleusercontent.com",buttonText:"Logout",onLogoutSuccess:function(){console.log("Logout made successfully"),alert("Logout made successfully \u270c"),e.setLoggedIn(!1)}})})};function A(e){var t=Object(o.useState)(!1),n=Object(b.a)(t,2),c=n[0],r=n[1],s=Object(o.useState)(),u=Object(b.a)(s,2),l=u[0],d=u[1];return Object(a.jsxs)("div",{children:[!c&&Object(a.jsx)(S,{loggedIn:c,setLoggedIn:function(e){return r(e)},setName:function(e){return d(e)}}),c?Object(a.jsxs)("p",{children:["Hello ",l]}):Object(a.jsx)("p",{children:"Not logged in"}),c&&Object(a.jsxs)("div",{children:[Object(a.jsx)(i.b,{to:"/draw",children:"Go to Drawing"}),Object(a.jsx)("hr",{}),Object(a.jsx)(_,{loggedIn:c,setLoggedIn:function(e){return r(e)}})]})]})}n(162);var C=function(){var e=Object(o.useState)("#000000"),t=Object(b.a)(e,2),n=t[0],c=t[1],r=Object(o.useContext)(p),s=Object(b.a)(r,2),i=s[0],u=s[1];Object(o.useEffect)((function(){console.log("Changed hexcode"),console.log("\n      local hexcode: ".concat(n,"\n      global hexcode: ").concat(i.colorHexCode,"\n    "))}),[n]);return Object(a.jsx)("div",{children:Object(a.jsxs)("div",{children:["Select Brush Color: \xa0",Object(a.jsx)("input",{type:"color",value:n,onChange:function(e){var t;u({type:"setColorHexCode",obj:e.target.value}),c(e.target.value),t=e.target.value,console.log("written"),d.a.database().ref("board/"+i.googleObj.googleId).update({colorHexCode:t})}})]})})};var P=function(e){var t,n=Object(o.useRef)([]),c=Object(o.useRef)(),r=Object(o.useRef)(null),s=(Object(o.useRef)(null),Object(o.useState)(!1)),i=Object(b.a)(s,2),u=i[0],l=i[1],j=Object(o.useState)(!1),g=Object(b.a)(j,2),O=g[0],h=g[1],E=Object(o.useState)("Draw"),x=Object(b.a)(E,2),I=x[0],S=x[1],_=Object(o.useState)(!1),A=Object(b.a)(_,2),P=A[0],R=A[1],m=Object(o.useState)(0),w=Object(b.a)(m,2),y=w[0],T=w[1],D=Object(o.useState)(0),N=Object(b.a)(D,2),k=N[0],L=N[1],F=Object(o.useContext)(p),B=Object(b.a)(F,2),H=B[0],G=(B[1],Object(o.useState)(0)),K=Object(b.a)(G,2),M=K[0],U=(K[1],Object(o.useState)(["canvas0","canvas1","canvas2","canvas3","canvas4","canvas5","canvas6","canvas7","canvas8","canvas9","canvas10","canvas11","canvas12","canvas13","canvas14","canvas15","canvas16","canvas17","canvas18","canvas19"])),W=Object(b.a)(U,2),q=W[0],X=(W[1],Object(o.useState)([])),Y=Object(b.a)(X,2),z=Y[0],V=Y[1];Object(o.useEffect)((function(){r.current&&(r.current.strokeStyle=H.colorHexCode)}),[H.colorHexCode]),Object(o.useEffect)((function(){for(var a=0;a<20;a++)n.current[a]&&(n.current[a].width=2*e.width,n.current[a].height=2*e.height,n.current[a].style.width="".concat(e.width,"px"),n.current[a].style.height="".concat(e.height,"px"));c.current.width=2*e.width,c.current.height=2*e.height,c.current.style.width="".concat(e.width,"px"),c.current.style.height="".concat(e.height,"px");for(var o=[],s=0;s<20;s++){var i=n.current[s].getContext("2d");i.scale(2,2),i.lineCap="round",i.strokeStyle="black",i.lineWidth=10,o.push(i)}V(o),console.log(z),z[e.canvasId]&&((t=z[e.canvasId]).strokeStyle=H.colorHexCode),r.current=t,d.a.database().ref("board/").on("value",(function(t){if(t.exists()){var a=!1;t.forEach((function(t){if(t.val().isDrawing){if(a=!0,console.log("boolean val: "+(e.uid===t.key)),e.uid===t.key)return 0;if(null==z[t.val().canvasId])return console.log("canvasRef is null for "+t.val().canvasId),void console.log(n.current[1]);var o=z[t.val().canvasId],r=c.current.getContext("2d");o.strokeStyle=t.val().colorHexCode,o.beginPath(),o.moveTo(t.val().x1,t.val().y1),o.lineTo(t.val().x2,t.val().y2),o.stroke(),o.closePath(),r.drawImage(n.current[t.val().canvasId],0,0),o.clearRect(0,0,2*e.width,2*e.height),console.log("written")}})),R(!!a)}else console.log("No data available")}))}),[e.width,e.height,n,M]);var Z=function(){var t=Object(v.a)(f.a.mark((function t(n,a,o,c){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:u?d.a.database().ref("board/"+e.uid).update({x1:o,y1:c,x2:n,y2:a}):d.a.database().ref("board/"+e.uid).update({x1:n,y1:a,x2:n,y2:a});case 1:case"end":return t.stop()}}),t)})));return function(e,n,a,o){return t.apply(this,arguments)}}(),Q=function(t){d.a.database().ref("board/"+e.uid).update({isDrawing:t},(function(e){e&&console.log("writeNotDrawing Failed")}))},J=function(){var e=Object(v.a)(f.a.mark((function e(t){var n,a,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.nativeEvent,O){e.next=4;break}return console.log("cant draw"),e.abrupt("return");case 4:return console.log("start"),a=n.offsetX,o=n.offsetY,r.current.beginPath(),r.current.moveTo(a,o),e.next=10,Z(a,o,0,0);case 10:T(a),L(o),l(!0),Q(!0);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$=function(){var e=Object(v.a)(f.a.mark((function e(t){var n,a,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.nativeEvent,u&&O){e.next=3;break}return e.abrupt("return");case 3:return a=n.offsetX,o=n.offsetY,e.next=6,Z(a,o,y,k);case 6:T(a),L(o),r.current.lineTo(a,o),r.current.stroke();case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.jsxs)("div",{children:[Object(a.jsxs)("div",{style:{position:"relative"},children:[Object(a.jsx)("canvas",{onMouseDown:J,onMouseUp:function(){r.current.closePath(),c.current.getContext("2d").drawImage(n.current[e.canvasId],0,0),r.current.clearRect(0,0,e.width,e.height),l(!1),Q(!1)},onMouseMove:$,ref:function(t){return n.current[e.canvasId]=t},id:"canvas"+e.canvasId,style:{position:"absolute",left:0,top:0,zIndex:100}},e.canvasId),q.map((function(t,o){return o==e.canvasId?null:Object(a.jsx)("canvas",{ref:function(e){return n.current[o]=e},id:t,style:{position:"absolute",left:0,top:0,zIndex:o}},o)})),Object(a.jsx)("canvas",{ref:c,id:"backgroundCanvas",style:{position:"absolute",left:0,top:0,zIndex:0}},-1)]}),Object(a.jsx)("div",{style:{width:e.width,height:e.height}}),Object(a.jsxs)("div",{children:[Object(a.jsx)("button",{type:"button",onClick:function(){O?(h(!1),S("Draw")):(console.log("Can draw"),h(!0),S("Stop Draw"))},children:I}),Object(a.jsx)("div",{style:{width:"50px",height:"auto",display:"inline-block"}}),Object(a.jsx)("button",{type:"button",onClick:function(){var t=c.current.getContext("2d");console.log(e.width+" _____ "+e.height),t.clearRect(0,0,2*e.width,2*e.height)},children:"Clear"})]}),Object(a.jsx)("div",{children:P?"Someone is Drawing":"No one is Drawing"}),Object(a.jsx)("div",{children:Object(a.jsx)(C,{})})]})};var R=function(){var e=Object(o.useRef)(null),t=Object(o.useState)({width:0,height:0}),n=Object(b.a)(t,2),c=n[0],r=n[1],s=Object(o.useContext)(p),i=Object(b.a)(s,2),u=i[0];return i[1],Object(o.useEffect)((function(){r({width:e.current.clientWidth,height:e.current.clientHeight})}),[]),console.log("From Container:"+u.canvasId),Object(a.jsx)("div",{style:{height:"600px",width:"60%",backgroundColor:"powderblue"},ref:e,children:Object(a.jsx)(P,{width:c.width,height:c.height,uid:u.googleObj.googleId,canvasId:u.canvasId})})};var m=function(){return Object(a.jsx)(x,{children:Object(a.jsx)(i.a,{children:Object(a.jsx)("div",{className:"App",children:Object(a.jsx)("header",{className:"App-header",children:Object(a.jsxs)(u.c,{children:[Object(a.jsx)(u.a,{path:"/",exact:!0,component:function(){return Object(a.jsx)(l,{children:Object(a.jsx)(A,{})})}}),Object(a.jsx)(u.a,{path:"/draw",exact:!0,component:R})]})})})})})},w=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,457)).then((function(t){var n=t.getCLS,a=t.getFID,o=t.getFCP,c=t.getLCP,r=t.getTTFB;n(e),a(e),o(e),c(e),r(e)}))};s.a.render(Object(a.jsx)(c.a.StrictMode,{children:Object(a.jsx)(m,{})}),document.getElementById("root")),w()}},[[455,1,2]]]);
//# sourceMappingURL=main.6f7daa28.chunk.js.map